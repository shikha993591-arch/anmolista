<!DOCTYPE html>
<html>
<head>
<title>Anmolista Chats</title>
<style>
body{margin:0;background:#111;color:white;font-family:Arial}
header{background:#1f1f1f;padding:12px;font-size:18px}
.user{padding:12px;border-bottom:1px solid #333;cursor:pointer}
.user:hover{background:#222}
</style>
</head>
<body>

<header>Anmolista Chats</header>
<div id="list"></div>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
  apiKey:"AIzaSyBpF3Q1ESL76ywrp2_OVOoOJiFOv322z5M",
  authDomain:"anmolista.firebaseapp.com",
  projectId:"anmolista"
});
const auth=firebase.auth();
const db=firebase.firestore();

auth.onAuthStateChanged(u=>{
  if(!u) location.href="index.html";
  db.collection("users").get().then(s=>{
    s.forEach(d=>{
      if(d.id!==u.uid){
        list.innerHTML+=
          `<div class="user" onclick="openChat('${d.id}')">
            ${d.data().email}
          </div>`;
      }
    });
  });
});

function openChat(id){
  location.href="chat.html?uid="+id;
}
</script>
</body>
</html>
